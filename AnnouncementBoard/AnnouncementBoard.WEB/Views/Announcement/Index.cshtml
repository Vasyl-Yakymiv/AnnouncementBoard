@model IEnumerable<AnnouncementBoard.WEB.Models.Announcement>

@{
    ViewData["Title"] = "Оголошення";
}

<h2>Оголошення</h2>

<form method="get" asp-action="Index" class="row g-3 mb-4">
    <div class="col-md-4">
        <label for="categorySelect" class="form-label">Категорія</label>
        <select id="categorySelect" name="category" class="form-select" onchange="onCategoryChange()">
            <option value="">-- Всі категорії --</option>
            <option value="Побутова техніка">Побутова техніка</option>
            <option value="Комп'ютерна техніка">Комп'ютерна техніка</option>
            <option value="Смартфони">Смартфони</option>
            <option value="Інше">Інше</option>
        </select>
    </div>

    <div class="col-md-4">
        <label for="subCategorySelect" class="form-label">Підкатегорія</label>
        <select id="subCategorySelect" name="subCategory" class="form-select">
            <option value="">-- Всі підкатегорії --</option>
        </select>
    </div>

    <div class="col-md-4 d-flex align-items-end">
        <button type="submit" class="btn btn-primary w-100">Фільтрувати</button>
    </div>
</form>

<div class="row">
    @foreach (var item in Model)
    {
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">@item.Title</h5>
                    <p class="card-text">@item.Description</p>
                    <p class="text-muted">@item.Category / @item.SubCategory</p>
                    <span class="badge @(item.Status == "Active" ? "bg-success" : "bg-secondary")">
                        @item.Status
                    </span>
                </div>
                <div class="card-footer text-end">
                    <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-sm btn-warning">Редагувати</a>
                    <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-sm btn-danger">Видалити</a>
                </div>
            </div>
        </div>
    }
</div>

@section Scripts {
    <script>
        const subCategories = {
            "Побутова техніка": ["Холодильники", "Пральні машини", "Бойлери", "Печі", "Витяжки", "Мікрохвильові печі"],
            "Комп'ютерна техніка": ["ПК", "Ноутбуки", "Монітори", "Принтери", "Сканери"],
            "Смартфони": ["Android смартфони", "iOS/Apple смартфони"],
            "Інше": ["Одяг", "Взуття", "Аксесуари", "Спортивне обладнання", "Іграшки"]
        };

        function onCategoryChange() {
            const category = document.getElementById("categorySelect").value;
            const subCategorySelect = document.getElementById("subCategorySelect");

            subCategorySelect.innerHTML = '<option value="">-- Всі підкатегорії --</option>';

            if (subCategories[category]) {
                subCategories[category].forEach(sub => {
                    const option = document.createElement("option");
                    option.value = sub;
                    option.text = sub;
                    subCategorySelect.appendChild(option);
                });
            }
        }

        // Автозаповнення підкатегорій при повторному завантаженні сторінки
        document.addEventListener("DOMContentLoaded", onCategoryChange);
    </script>
}
